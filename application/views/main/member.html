<div class="main left">
    <div class="nav-title">{$menu}</div>

    <div class="member-total">
        {foreach from=$group_count key=key item=one}
            <span class="group-count">{$one.type_name}
                <span data-type="{$one.type}" class="{if $key !=0}group-count-value{/if}">[{$one.num}]</span>
            </span>
        {/foreach}
    </div>

    <div class="content-list"></div>
    <input type="hidden" id="unique-id" value="{$user.user_id}" />
    <input type="hidden" id="initial_type" value="{$initial_type}" />

    <script src="/resources/js/tmpl.js"></script>
    <script id="content-list" type="text/x-dot-template">
    {literal}
    {{if count > 0}}
        {{if count > 10}}<div class="pagination page-top">{{html page}}</div>{{/if}}
        <div class="main-list">
            {{each(key,one) list}}
            <div class="one{{if key == 0 }} first{{/if}}">
                {{if is_detail == 1}}
                    <div class="article-one-left">
                        <p class="detail-wapper">
                            <a class="detail-title" target="_blank" href="${one.detail_url}">${one.title}</a>
                        </p>
                        <p class="detail-tags">标签：<span>${one.tags}</span></p>
                        <p class="article-click oo-xx">
                            <span class="time text-right">${one.name}</span>
                            <span class="time text-right"> 发表于${one.create_time}</span>
                            <span class="response"></span>
                            <span class="jian-ge">&nbsp;&nbsp;</span>
                            <a class="oo" data-id="{$one.con_id}"></a>[<span class="good">${one.good}</span>]
                            <span class="jian-ge">&nbsp;</span>
                            <a class="xx" data-id="{$one.con_id}"></a>[<span class="bad">${one.bad}</span>]
                            <span class="jian-ge">&nbsp;</span>
                            <span class="examine">
                                <span class="jian-ge">&nbsp;</span>
                                <span class="reply time cursor" data-id="{$one.con_id}"></span>[<span class="reply-count">${one.reply}</span>]
                            </span>
                            <span class="jian-ge">&nbsp;</span>
                            <span class="scan time">浏览[${one.scan}]</span>
                        </p>
                    </div>
                    <div class="article-one-right">
                        <strong>${one.day}</strong>
                        ${one.year}
                    </div>
                {{else}}
                    <div class="user member">
                        <p class="time text-right" title="${one.u_name}">${one.name}</p>
                        <p class="time text-right">发表于 ${one.create_time}</p>
                    </div>
                    <div class="content">
                        <div class="content-body">{{html one.content}}</div>
                        <p class="right clear click oo-xx">
                            <span class="response"></span>
                            <a class="oo" data-id="${one.con_id}"></a>[<span class="good">${one.good}</span>]
                            <a class="xx" data-id="${one.con_id}"></a>[<span class="bad">${one.bad}</span>]
                            <span class="examine"><a class="reply" data-id="${one.con_id}"></a>[<span class="reply-count">${one.reply}</span>]</span>
                            </p>
                        </div>
                    {{/if}}
                </div>
                {{/each}}
            </div>
            {{if count > 10}}<div class="pagination">{{html page}}</div>{{/if}}
        {{else}}
            <div class="empty"><h2 class="center">还没有发表过东西哦</h2></div>
        {{/if}}
        <input type="hidden" id="type" value="${type}" />
        {{if is_detail == 1}}
            <input type="hidden" id="comment-url" value="/article/record" />
        {{else}}
            <input type="hidden" id="comment-url" value="/content/record" />
        {{/if}}
        {/literal}
        </script>
</div>
<div class="right-container left">
    <div class="member-user-info">
        {if $user.avatar != ''}<div class="reply-avatar"><img src="{$user.avatar}" /></div>{/if}
    </div>
    <div class="left member-user-info-right">
        <p>性别：{$user.sex}</p>
        <p>年龄：{$user.age}</p>
    </div>
</div>
<script type="text/javascript">
$(function(){
    ajax_page(0);
})
function ajax_page(page){
    var user_id = $('#unique-id').val();
    if($("#type").length > 0){
        var type = $('#type').val();
    }else{
        var type = $('#initial_type').val();
    }
    $.ajax({
        url: "/member_list",
        data:{
            "id" : user_id,
            "type" : type,
            "page":page
        },
        type: "POST",
        dataType:'json',
        beforeSend: function() {
        //    $('.content-list').html('<h2 class="center">数据加载中...</h2>');
        },
        success:function(result){
            if(result.status == "error"){
                alert_msg(result.msg);
                return false;
            }
            $('.content-list').html('');
            $("#content-list").tmpl(result.data).appendTo('.content-list');
        },
        error:function(e){
            alert_msg('请求失败，请刷新重试');
        }
    });
}

$('body').on('click', '.group-count-value', function(){
    if(!$(this).hasClass("group-count-value")){
        return false;
    }
    $('#type').val($(this).attr('data-type'));
    $(this).removeClass("group-count-value").parent().siblings().children().addClass('group-count-value');
    ajax_page(0);
})
</script>